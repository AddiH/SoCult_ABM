---
title: "Viz"
author: "Astrid Elmann Hansen"
date: '2022-06-21'
output: html_document
---

```{r}
pacman::p_load(tidyverse, igraph)
df <- read_csv("dyads_his.csv")
N <- length(unique(df$agent_1))
```

```{r}

รถ <- "dep"

```


```{r}
df_viz <- df %>% 
  filter(tick == 99) %>% 
  mutate(weight = .data[[รถ]]) %>% 
  select(agent_1, agent_2, weight) 

tictog <- graph_from_data_frame(df_viz, directed = FALSE, vertices = NULL) # make into igraph object
tictog <- simplify(tictog) # remove duplicate edges
```


```{r}
col <- rainbow(N)

filename <- sprintf("plots/ticks_tog_%s_ticks.jpeg", ticks)

#jpeg(filename, width=20, height=20, units="cm", res=600)  # open doc
plot(tictog, 
     vertex.color = col,
     vertex.size = 10,
     vertex.label = NA,
     layout = layout_on_sphere(tictog),
     edge.width = E(tictog)$weight/1000)
#dev.off() # close doc
```


---
title: "viz_dyads"
author: "Astrid Elmann Hansen"
date: '2022-08-03'
output: html_document
---

```{r ignore}
pacman::p_load(tidyverse)
```

```{r edit}
file <- filename
```

```{r ignore}
df <- read_csv(file, # loading file with correct classes
               col_types = list(
                 agent_1 = "f",
                 agent_2 = "f",
                 tick_no = "i",
                 ticks_tog = "i"
               ))

N <- length(unique(df$agent_1))
ticks <- max(df$tick_no)
x <- "tick_no"
path <- c("sat", "dep", "commit", "cl_alt","cl_sat", "ticks_tog")  
point <- c("outcome", "out_sat", "out_dep", "ac", "pc", "jc", "LOD", "COI", "BOD", "MOD")
```

```{r edit}
# agents to look at
A <- 3
B <- 4

theory <- "Investment"
```

```{r dyad}
dyad <- df %>% filter(agent_1 == A & agent_2 == B | 
                      agent_1 == B & agent_2 == A) # find info for relevant dyad

t <- dyad %>% filter(date == T) %>% select(tick_no) %>% distinct() 
t <- unique(t$tick_no) # list of ticks the dyad spent together


color <- "agent_1"

for (y in path){
plot <- dyad %>%
  ggplot(aes(x = .data[[x]], y = .data[[y]], color = .data[[color]])) +
  geom_vline(xintercept = t, color = "#e3e3e3") +  
  geom_path() +
  labs(title = theory,
        x ="Time", 
        y = y,
        color = color,
        subtitle = "Line marks a date") +
  theme(plot.subtitle = element_text(color = "grey")) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
print(plot)
}

for (y in point){
plot <- dyad %>%
  filter(date == T) %>% 
  ggplot(aes(x = .data[[x]], y = .data[[y]], color = .data[[color]])) +
  geom_point() +
  labs(title = theory,
        x ="Time", 
        y = y,
        color = color,
        subtitle = "Line marks a date") +
  theme(plot.subtitle = element_text(color = "grey")) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
print(plot)
}
```

```{r individual}
dyad <- df %>% filter(agent_1 == A) # find info for relevant dyad
color <- "agent_2"

for (y in path){
plot <- dyad %>%
  ggplot(aes(x = .data[[x]], y = .data[[y]], color = .data[[color]])) +
  geom_path() +
  labs(title = theory,
        x ="Time", 
        y = y,
        color = color,
        subtitle = "Line marks a date") +
  theme(plot.subtitle = element_text(color = "grey")) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
print(plot)
}

for (y in point){
plot <- dyad %>%
  filter(date == T) %>% 
  ggplot(aes(x = .data[[x]], y = .data[[y]], color = .data[[color]])) +
  geom_point() +
  labs(title = theory,
        x ="Time", 
        y = y,
        color = color,
        subtitle = "Line marks a date") +
  theme(plot.subtitle = element_text(color = "grey")) +
  theme(panel.grid.major = element_blank(), 
        panel.grid.minor = element_blank(),
        panel.background = element_blank(), 
        axis.line = element_line(colour = "black"))
print(plot)
}
```
